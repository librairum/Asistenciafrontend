<!-- asistencia.component.html -->
<p-toast></p-toast>
<div class="m-3">
    <p-panel header="Consulta de Resumen de Asistencia">
      <p-breadcrumb class="max-w-full" [model]="items" />
      <br />
      <div class="grid align-items-center">
        <!-- Fecha de Inicio -->
        <div class="col-3 text-center">
          <div class="field">
            <label for="startDate" class="mr-2 font-medium text-gray-700">Fecha de Inicio</label>
            <br />
            <p-calendar
              dateFormat="yy-mm-dd"
              [(ngModel)]="startDate"
              inputId="startDate"
              class="w-full"
              placeholder="Selecciona una fecha"
              [showIcon]="true">
            </p-calendar>
          </div>
        </div>

        <!-- Fecha Fin -->
        <div class="col-3 text-center">
          <div class="field">
            <label for="endDate" class="mr-2 font-medium text-gray-700">Fecha Fin</label>
            <br />
            <p-calendar
              dateFormat="yy-mm-dd"
              [(ngModel)]="endDate"
              inputId="endDate"
              class="w-full"
              placeholder="Selecciona una fecha"
              [showIcon]="true"
              class="col-3">
            </p-calendar>
          </div>
        </div>

        <!-- Planilla -->
        <div class="col-3 text-center">
          <div class="field">
            <label for="planilla" class="mr-2 font-medium text-gray-700">Planilla</label>
            <br />
            <p-dropdown
              [options]="planilla"
              optionLabel="nombrePlanilla"
              optionValue="codigoPlanilla"
              placeholder="Selecciona la planilla"
              [(ngModel)]="selectedPlanilla"
              panelStyle="170px">
            </p-dropdown>
          </div>
        </div>

        <!-- BotÃ³n Buscar -->
        <div class="col-3 text-center">
          <button
            pButton
            type="button"
            label="Buscar"
            icon="pi pi-search"
            (click)="cargarResumen()"
            class="w-auto p-button-sm">
          </button>
        </div>
      </div>
    </p-panel>
  </div>

  <div class="m-3">
    <p-table
      #dt1
      [value]="asistencia"
      [columns]="columnas"
      dataKey="item"
      [rows]="5"
      [rowsPerPageOptions]="[5, 10, 20]"
      [paginator]="true"
      [loading]="loading"
      [globalFilterFields]="columnsGlobalFilterFields"
      [tableStyle]="{ 'min-width': '75rem' }">

      <ng-template pTemplate="header" let-columns>
        <tr>
          <th *ngFor="let col of columns">{{ col.header }}</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-rowData>
        <tr>
          <td>{{ rowData.item }}</td>
          <td>{{ rowData.nombretrabajador }}</td>
          <td>{{ rowData.dias }}</td>
          <td>{{ rowData.horas25 }}</td>
          <td>{{ rowData.horas60 }}</td>
          <td>{{ rowData.horas100 }}</td>
          <td>
            <button
              pButton
              icon="pi pi-eye"
              label="Ver"
              class="p-button-sm"
              (click)="viewDetails(rowData)">
            </button>
          </td>
        </tr>
      </ng-template>

      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="7">No se encontraron registros.</td>
        </tr>
      </ng-template>
    </p-table>
  </div>
