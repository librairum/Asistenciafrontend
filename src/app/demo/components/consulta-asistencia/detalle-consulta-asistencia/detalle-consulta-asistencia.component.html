<!-- asistencia-detalle.component.html -->
<div class="m-3">
    <p-panel header="Detalle de Asistencia">
        <div>
            <p-breadcrumb [model]="breadcrumbs" [class]="'max-w-full'"></p-breadcrumb>
        </div>
        <div class="mt-4 text-left">
            <button pButton type="button" label="Exportar" icon="pi pi-file-excel"
                class="p-button-sm p-button-success" (click)="generateEXCEL()"></button>
        </div>
        <div class="mt-4">
            <p-table #dt1 [value]="asistencias" [tableStyle]="{ 'min-width': '100%' }">
                <ng-template pTemplate="header">
                    <tr>
                        <th>Item</th>
                        <th>Nro.Doc</th>
                        <th>Nombres <br/> Completo</th>
                        <th>Fecha</th>
                        <th>DÃ­a</th>
                        <th>Hora Entrada</th>
                        <th>Hora Salida</th>
                        <th>Dias falta</th>
                        <th>horas Domingo pagada</th>
                        <th>horas feriado trabajado</th>
                        <th>Horas turno Manual</th>
                        <th>Minutos tardanza</th>                        
                        <th>Horas 25</th>
                        <th>Horas 35</th>
                        <th>Horas 50</th>
                        <th>Horas 60</th>
                        <th>Horas Extra doble</th>
                    </tr>
                </ng-template>

                <ng-template pTemplate="body" let-rowData>
                    <tr>
                        <td>{{ rowData.item }}</td>
                        <td>{{rowData.codigotrabajador}}</td>
                        <td>{{ rowData.nombreTrabajador }}</td>                        
                        <td>{{ rowData.fechaMarcacion }}</td>                         
                         <td>{{ rowData.diaNombre}}</td>
                        <td>{{ rowData.horaEntrada }}</td>
                        <td>{{ rowData.horaSalida }}</td>
                        <td>{{ rowData.diasFalta }}</td>
                        <td>{{ rowData.nHraDomPag }}</td>
                        <td>{{ rowData.nHraFerTra }}</td>                                                
                        <td>{{ rowData.hturnoManu }}</td>
                        <td>{{ rowData.minTardanza }}</td>
                        <td>{{ rowData.nHorExtr25 }}</td>
                        <td>{{ rowData.nHorExtr35 }}</td>
                        <td>{{ rowData.nHorExtr50 }}</td>
                        <td>{{ rowData.nHorExtr60 }}</td>
                        <td>{{rowData.nHorExtrDo}}</td>
                    </tr>
                </ng-template>

                        <ng-template pTemplate="footer">
                            <tr>
                                <td colspan="8" class="text-right font-bold">Totales:</td>
                                <td>{{ calculateTotal('nHraDomPag') }}</td>
                                <td>{{ calculateTotal('nHraFerTra') }}</td>
                                <td>{{ calculateTotal('hturnoManu') }}</td>
                                <td>{{ calculateTotal('minTardanza') }}</td>
                                <td>{{ calculateTotal('nHorExtr25') }}</td>
                                <td>{{ calculateTotal('nHorExtr35') }}</td>
                                <td>{{ calculateTotal('nHorExtr50') }}</td>
                                <td>{{ calculateTotal('nHorExtr60') }}</td>
                                <td>{{ calculateTotal('nHorExtrDo') }}</td>
                            </tr>
                        </ng-template>
            </p-table>
        </div>
    </p-panel>
</div>
